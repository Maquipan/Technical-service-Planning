<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://i.imgur.com/jM5y1qT.png" type="image/png">
    <title>Portal de Aplicaciones Maquipan</title>
    <style>
        /* Estilos CSS Base */
        :root {
            --font-main: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            --transition-speed: 0.3s;
        }
        [data-theme="dark"] {
            --bg-primary: #1a1b26; --bg-secondary: #24283b; --bg-tertiary: #414868;
            --text-primary: #c0caf5; --text-secondary: #a9b1d6; --accent: #7dcfff;
            --accent-glow: rgba(125, 207, 255, 0.2); --border-color: #3b3f51;
            --bg-gradient: radial-gradient(circle at top left, rgba(125, 207, 255, 0.05), transparent 30%), radial-gradient(circle at bottom right, rgba(125, 207, 255, 0.05), transparent 30%);
        }
        [data-theme="light"] {
            --bg-primary: #f0f2f5; --bg-secondary: #ffffff; --bg-tertiary: #e9ecef;
            --text-primary: #212529; --text-secondary: #495057; --accent: #007bff;
            --accent-glow: rgba(0, 123, 255, 0.15); --border-color: #dee2e6;
            --bg-gradient: radial-gradient(circle at top left, rgba(0, 123, 255, 0.05), transparent 30%), radial-gradient(circle at bottom right, rgba(0, 123, 255, 0.05), transparent 30%);
        }
        *, *::before, *::after { box-sizing: border-box; }
        body {
            font-family: var(--font-main); margin: 0;
            background-color: var(--bg-primary); background-image: var(--bg-gradient);
            color: var(--text-primary); transition: background-color var(--transition-speed), color var(--transition-speed);
            display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 2rem 0;
        }
        .container { max-width: 900px; width: 100%; margin: 0 auto; padding: 1rem 1.5rem; }
        .header-controls {
            display: flex; justify-content: space-between; align-items: center;
            padding: 1.2rem 1.5rem; background-color: var(--bg-secondary);
            border-radius: 12px 12px 0 0; border: 1px solid var(--border-color); border-bottom: none;
        }
        .header-title { display: flex; align-items: center; gap: 1rem; }
        .logo { height: 35px; width: auto; object-fit: contain; }
        .header-controls h1 { margin: 0; font-size: 1.5rem; color: var(--text-primary); font-weight: 600; }
        .card { 
            background-color: var(--bg-secondary); border: 1px solid var(--border-color);
            border-radius: 0 0 12px 12px; padding: 2.5rem;
        }
        .widget-card {
            background-color: var(--bg-secondary); border: 1px solid var(--border-color);
            border-radius: 12px; padding: 1.5rem; margin-top: 1.5rem;
        }
        #welcome-header { text-align: center; margin-bottom: 2.5rem; }
        #greeting { font-size: 1.8rem; font-weight: 600; color: var(--text-primary); margin: 0; }
        #clock-date { font-size: 1rem; color: var(--text-secondary); }
        .portal-links { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; }
        .link-button {
            display: flex; flex-direction: column; align-items: center; justify-content: flex-start;
            background: var(--bg-tertiary); border: 1px solid var(--border-color);
            color: var(--text-primary); padding: 2rem 1.5rem; border-radius: 10px;
            cursor: pointer; text-decoration: none; text-align: center;
            transition: all var(--transition-speed);
            opacity: 0; animation: fadeIn 0.5s ease-out forwards;
        }
        .link-button:hover {
            color: var(--accent); border-color: var(--accent);
            box-shadow: 0 0 20px var(--accent-glow); transform: translateY(-5px);
        }
        .link-button svg { width: 42px; height: 42px; margin-bottom: 1rem; stroke: var(--accent); transition: transform var(--transition-speed); }
        .link-button:hover svg { transform: scale(1.1); }
        .link-button span { font-size: 1.2rem; font-weight: 600; }
        .link-description { font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.75rem; margin-bottom: 0; line-height: 1.4; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .link-button:nth-child(1) { animation-delay: 0.1s; } .link-button:nth-child(2) { animation-delay: 0.2s; }
        .link-button:nth-child(3) { animation-delay: 0.3s; } .link-button:nth-child(4) { animation-delay: 0.4s; }
        .header-right { display: flex; align-items: center; gap: 1.5rem; }
        #weather-widget {
            display: flex; align-items: center; gap: 0.75rem; color: var(--text-secondary);
            border-right: 1px solid var(--border-color); padding-right: 1.5rem;
        }
        #weather-icon { width: 40px; height: 40px; }
        #weather-temp { font-size: 1.2rem; font-weight: 600; color: var(--text-primary); }
        #weather-desc { font-size: 0.9rem; text-transform: capitalize; }
        .theme-switch { position: relative; display: inline-block; width: 50px; height: 26px; }
        .theme-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--bg-tertiary); transition: var(--transition-speed); border-radius: 26px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 4px; bottom: 4px; background-color: white; transition: var(--transition-speed); border-radius: 50%; }
        input:checked + .slider { background-color: var(--accent); }
        input:checked + .slider:before { transform: translateX(24px); }
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(36, 40, 59, 0.7); backdrop-filter: blur(5px);
            display: none; align-items: center; justify-content: center; z-index: 1000;
        }
        .modal-container {
            background-color: var(--bg-secondary); border: 1px solid var(--border-color);
            border-radius: 12px; padding: 2rem; width: 90%; max-width: 400px;
        }
        .modal-container h3 { margin-top: 0; color: var(--text-primary); }
        .modal-container p { color: var(--text-secondary); font-size: 0.9rem; }
        #password-input {
            width: 100%; padding: 0.75rem; font-size: 1rem; border: 1px solid var(--border-color);
            border-radius: 8px; background: var(--bg-tertiary); color: var(--text-primary);
            margin-top: 1rem; margin-bottom: 1.5rem;
        }
        .modal-buttons { display: flex; gap: 1rem; justify-content: flex-end; }
        .modal-buttons button {
            padding: 0.6rem 1.2rem; font-size: 0.9rem; border-radius: 8px;
            border: none; cursor: pointer; transition: all var(--transition-speed);
        }
        #modal-cancel-btn { background-color: var(--bg-tertiary); color: var(--text-secondary); }
        #modal-submit-btn { background-color: var(--accent); color: var(--bg-primary); }
    </style>
</head>
<body>
    
    <div class="container">
        <div class="header-controls">
            <div class="header-title">
                <img src="https://i.imgur.com/jM5y1qT.png" alt="Logo Maquipan" class="logo">
                <h1>Portal de Aplicaciones</h1>
            </div>
            <div class="header-right">
                <div id="weather-widget">
                    <img id="weather-icon" src="" alt="">
                    <div>
                        <span id="weather-temp">--掳C</span>
                        <div id="weather-desc">Cargando...</div>
                    </div>
                </div>
                <div class="theme-switch-wrapper">
                    <label class="theme-switch">
                        <input type="checkbox" id="theme-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
        </div>

        <div class="card">
            <div id="welcome-header">
                <h2 id="greeting"></h2>
                <p id="clock-date"></p>
            </div>
            <div class="portal-links">
                <a href="#" id="planificacion-link" class="link-button">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z" /></svg>
                    <span>Planificaci贸n</span>
                    <p class="link-description">Acceso al sistema de planificaci贸n y gesti贸n de servicios t茅cnicos.</p>
                </a>
                <a href="https://maquipan.github.io/ejecutivos/" target="_blank" class="link-button">
                     <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" /></svg>
                    <span>Ejecutivos</span>
                    <p class="link-description">Plataforma de seguimiento y gesti贸n para el equipo de ejecutivos.</p>
                </a>
                <a href="https://maquipan.github.io/Calendario-2.0/" target="_blank" class="link-button">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    <span>Calendario 2.0</span>
                    <p class="link-description">Visor de calendario avanzado para la coordinaci贸n de eventos y tareas.</p>
                </a>
                <a href="https://maquipan.github.io/visor-de-servicio/" target="_blank" class="link-button">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" /></svg>
                    <span>Visor de Servicio</span>
                    <p class="link-description">Herramienta para la consulta y visualizaci贸n de detalles de servicios.</p>
                </a>
            </div>
        </div>

        <div class="widget-card">
            <div id="horoscope-widget" style="text-align: center;">
                <h3 style="margin-top:0; color: var(--text-primary);">Hor贸scopo del D铆a</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">Selecciona tu signo para ver tu predicci贸n:</p>
                <select id="sign-selector" style="width: 200px; padding: 0.5rem; font-size: 1rem; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-tertiary); color: var(--text-primary);">
                    <option value="" disabled selected>Elige un signo</option>
                    <option value="aries">Aries</option><option value="taurus">Tauro</option><option value="gemini">G茅minis</option>
                    <option value="cancer">C谩ncer</option><option value="leo">Leo</option><option value="virgo">Virgo</option>
                    <option value="libra">Libra</option><option value="scorpio">Escorpio</option><option value="sagittarius">Sagitario</option>
                    <option value="capricorn">Capricornio</option><option value="aquarius">Acuario</option><option value="pisces">Piscis</option>
                </select>
                <div id="horoscope-result" style="margin-top: 1.5rem; padding: 1rem; border: 1px dashed var(--border-color); border-radius: 8px; min-height: 100px; color: var(--text-secondary);">
                    <p id="horoscope-text">Tu predicci贸n aparecer谩 aqu铆...</p>
                </div>
            </div>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
            <div class="widget-card">
                <h3 style="margin-top:0;">Novedades Maquipan</h3>
                <ul id="news-list" style="padding-left: 20px; color: var(--text-secondary);"></ul>
            </div>
            <div class="widget-card" style="text-align: center;">
                <h3 style="margin-top:0;"> 隆Feliz Cumplea帽os! </h3>
                <p id="birthday-names" style="color: var(--accent); font-weight: bold;"></p>
            </div>
            <div class="widget-card" style="text-align: center;">
                <h3 style="margin-top:0;">Sab铆as que...</h3>
                <p id="daily-fact" style="font-style: italic; color: var(--text-secondary);"></p>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="password-modal">
        <div class="modal-container">
            <h3>Acceso Restringido</h3>
            <p>Para acceder a Planificaci贸n, por favor ingresa la clave de acceso.</p>
            <input type="password" id="password-input" placeholder="Escribe la clave aqu铆...">
            <div class="modal-buttons">
                <button id="modal-cancel-btn">Cancelar</button>
                <button id="modal-submit-btn">Ingresar</button>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- Control del Tema (Oscuro/Claro) ---
        const themeToggle = document.getElementById('theme-toggle');
        function toggleTheme(isDark) { document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light'); localStorage.setItem('theme', isDark ? 'dark' : 'light'); }
        themeToggle.addEventListener('change', (e) => toggleTheme(e.target.checked));
        const savedTheme = localStorage.getItem('theme') || 'dark';
        toggleTheme(savedTheme === 'dark'); themeToggle.checked = savedTheme === 'dark';

        // --- Saludo din谩mico y Reloj ---
        const greetingEl = document.getElementById('greeting');
        const clockDateEl = document.getElementById('clock-date');
        function updateClockAndGreeting() {
            const now = new Date(); const hours = now.getHours();
            let greetingText = 'Buenas Noches';
            if (hours >= 5 && hours < 12) { greetingText = 'Buenos D铆as'; } else if (hours >= 12 && hours < 21) { greetingText = 'Buenas Tardes'; }
            greetingEl.textContent = greetingText;
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
            const formattedDate = now.toLocaleDateString('es-CL', dateOptions);
            const formattedTime = now.toLocaleTimeString('es-CL', timeOptions);
            clockDateEl.textContent = `${formattedDate.charAt(0).toUpperCase() + formattedDate.slice(1)} | ${formattedTime}`;
        }
        setInterval(updateClockAndGreeting, 1000); updateClockAndGreeting();

        // --- L贸gica para el Modal de Contrase帽a ---
        const planificacionLink = document.getElementById('planificacion-link');
        const passwordModal = document.getElementById('password-modal');
        const passwordInput = document.getElementById('password-input');
        const cancelBtn = document.getElementById('modal-cancel-btn');
        const submitBtn = document.getElementById('modal-submit-btn');
        function checkPassword() {
            const encodedPass = "QW1vYVBpbWVudGVs"; const url = "https://maquipan.github.io/Planificacion/";
            if (passwordInput.value.trim() === atob(encodedPass)) {
                window.open(url, '_blank'); passwordModal.style.display = 'none'; passwordInput.value = "";
            } else { alert("Clave incorrecta."); passwordInput.focus(); }
        }
        planificacionLink.addEventListener('click', function(event) {
            event.preventDefault(); passwordModal.style.display = 'flex'; passwordInput.focus();
        });
        cancelBtn.addEventListener('click', () => { passwordModal.style.display = 'none'; });
        passwordModal.addEventListener('click', (event) => { if (event.target === passwordModal) { passwordModal.style.display = 'none'; }});
        submitBtn.addEventListener('click', checkPassword);
        passwordInput.addEventListener('keyup', (event) => { if (event.key === 'Enter') { checkPassword(); } });

        // --- L贸gica del Clima ---
        const fetchWeather = () => {
            const apiKey = '047bc4a894d2f2cfbaf93df3c32ecd55'; const cityId = '3868621'; // Villa Alemana, CL
            const apiUrl = `https://api.openweathermap.org/data/2.5/weather?id=${cityId}&appid=${apiKey}&units=metric&lang=es`;
            fetch(apiUrl).then(response => { if (!response.ok) throw new Error('Error de red.'); return response.json(); })
                .then(data => {
                    document.getElementById('weather-temp').textContent = `${Math.round(data.main.temp)}掳C`;
                    document.getElementById('weather-desc').textContent = data.weather[0].description;
                    document.getElementById('weather-icon').src = `https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png`;
                    document.getElementById('weather-icon').alt = data.weather[0].description;
                }).catch(error => { console.error('Error al cargar el clima:', error); document.getElementById('weather-desc').textContent = 'Error clima'; });
        };

        // --- L贸gica del Hor贸scopo (NUEVA API) ---
        const fetchHoroscope = (sign) => {
            const horoscopeTextEl = document.getElementById('horoscope-text');
            if (!sign) { return; }
            horoscopeTextEl.textContent = 'Cargando tu hor贸scopo...';
            // Esta API (horoscope-app-api) es m谩s estable y no requiere registro.
            fetch(`https://horoscope-app-api.vercel.app/api/v1/get-horoscope/daily?sign=${sign}&day=TODAY`)
                .then(response => { 
                    if (!response.ok) throw new Error('API no disponible o signo inv谩lido.'); 
                    return response.json(); 
                })
                .then(data => {
                    // La API devuelve el texto en 'horoscope_data'
                    const prediction = data.data.horoscope_data;
                    horoscopeTextEl.textContent = prediction;
                }).catch(error => { 
                    console.error('Error al cargar el hor贸scopo:', error); 
                    horoscopeTextEl.textContent = 'No se pudo cargar tu predicci贸n en este momento.'; 
                });
        };
        document.getElementById('sign-selector').addEventListener('change', (event) => fetchHoroscope(event.target.value));


        // --- L贸gica de Novedades ---
        const news = [ { date: "30/07/2025", text: "隆Nuevo r茅cord de instalaciones en la V Regi贸n!" }, { date: "25/07/2025", text: "Capacitaci贸n de seguridad programada para el pr贸ximo viernes." }, { date: "22/07/2025", text: "Bienvenidos los nuevos integrantes al equipo t茅cnico." }];
        const newsList = document.getElementById('news-list');
        news.forEach(item => { const li = document.createElement('li'); li.innerHTML = `<b>${item.date}:</b> ${item.text}`; newsList.appendChild(li); });
        
        // --- L贸gica de Cumplea帽os ---
        const birthdays = [ { name: "Juan P茅rez", month: 7, day: 30 }, { name: "Ana铆s Rivera", month: 8, day: 1 } ];
        const currentMonth = new Date().getMonth() + 1; const currentDay = new Date().getDate();
        const todaysBirthdays = birthdays.filter(b => b.month === currentMonth && b.day === currentDay);
        const birthdayNamesEl = document.getElementById('birthday-names');
        if (todaysBirthdays.length > 0) { birthdayNamesEl.textContent = todaysBirthdays.map(b => b.name).join(', '); } 
        else { birthdayNamesEl.textContent = "Hoy no hay cumplea帽os en el equipo."; }

        // --- L贸gica del Dato Curioso ---
        const facts = [
            "El pan es uno de los alimentos m谩s antiguos, con evidencias de hace m谩s de 14,000 a帽os.", "La primera m谩quina para amasar pan fue inventada por un ingeniero franc茅s en 1760.",
            "Contrario a la creencia popular, el croissant se origin贸 en Viena, Austria, no en Francia.", "El olor a pan reci茅n horneado es uno de los que genera mayor sensaci贸n de confort y hogar.",
            "La Torre Eiffel puede ser 15 cm m谩s alta durante el verano.", "Los pulpos tienen tres corazones y su sangre es azul.",
            "En Suiza es ilegal tener solo una cobaya (cuy).", "El coraz贸n de una ballena azul es tan grande que un humano podr铆a nadar por sus arterias.",
            "Las abejas pueden reconocer rostros humanos.", "La miel nunca se echa a perder.", "Un grupo de flamencos se llama 'flamboyance'.",
            "Hay m谩s 谩rboles en la Tierra que estrellas en la V铆a L谩ctea.", "Las nutrias se toman de las manos cuando duermen para no separarse.",
            "El inventor de los Pringles fue enterrado en una lata de Pringles.", "Rusia tiene una superficie m谩s grande que Plut贸n.",
            "Las vacas tienen mejores amigas y se estresan si se separan.", "El nombre completo de Barbie es Barbara Millicent Roberts.",
        ];
        const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));
        document.getElementById('daily-fact').textContent = `"${facts[dayOfYear % facts.length]}"`;

        // --- Llamadas iniciales al cargar la p谩gina ---
        fetchWeather();
    });
    </script>
</body>
</html>
